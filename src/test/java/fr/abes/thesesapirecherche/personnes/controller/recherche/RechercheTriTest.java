package fr.abes.thesesapirecherche.personnes.controller.recherche;

import fr.abes.thesesapirecherche.EnableOnIntegrationTest;
import fr.abes.thesesapirecherche.personnes.controller.PersonneControllerTest;
import org.hamcrest.Matchers;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

public class RechercheTriTest extends PersonneControllerTest {

    @Test
    @DisplayName("Tri A-Z sur la recherche de personnes")
    @EnableOnIntegrationTest
    public void triAZ() throws Exception {
        mockMvc.perform(get("/api/v1/tests/personnes/recherche/?q=*&index=per_recherche_simple_nom_prenom&tri=PersonnesAsc&debut=0&nombre=1000"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.personnes[0].theses[?(@.id=='2011ANGE0040')]").exists())
                .andExpect(jsonPath("$.personnes[1].theses[?(@.id=='2003PA066582')]").exists())
                .andExpect(jsonPath("$.personnes[2].theses[?(@.id=='1999ROUES082')]").exists())
                .andExpect(jsonPath("$.personnes[3].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[5].theses[?(@.id=='2007PA066375')]").exists())
                .andExpect(jsonPath("$.personnes[6].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[7].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[8].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[9].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[10].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[11].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[12].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[13].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[14].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[15].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[16].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[17].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[18].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[19].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[20].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[21].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[22].theses[?(@.id=='2020REN1B015')]").exists())
                .andExpect(jsonPath("$.personnes[23].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[24].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[25].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[26].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[27].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[28].theses[?(@.id=='2004BRES2040')]").exists())
                .andExpect(jsonPath("$.personnes[29].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[30].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[31].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[32].theses[?(@.id=='2020PA01H073')]").exists())
                .andExpect(jsonPath("$.personnes[33].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[34].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[35].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[36].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[37].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[38].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[39].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[40].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[41].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[42].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[43].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[44].theses[?(@.id=='1997PA040286')]").exists())
                .andExpect(jsonPath("$.personnes[45].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[46].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[47].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[48].theses[?(@.id=='1999ROUES082')]").exists())
                .andExpect(jsonPath("$.personnes[49].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[50].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[51].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[52].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[53].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[54].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[55].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[56].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[57].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[58].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[59].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[60].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[61].theses[?(@.id=='2004BRES2040')]").exists())
                .andExpect(jsonPath("$.personnes[62].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[63].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[64].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[66].theses[?(@.id=='2007PA066375')]").exists())
                .andExpect(jsonPath("$.personnes[67].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[68].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[69].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[70].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[71].theses[?(@.id=='1997PA040286')]").exists())
                .andExpect(jsonPath("$.personnes[72].theses[?(@.id=='2020PA01H073')]").exists())
                .andExpect(jsonPath("$.personnes[73].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[74].theses[?(@.id=='2021SORUL154')]").exists())
                .andExpect(jsonPath("$.personnes[75].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[76].theses[?(@.id=='2003PA066582')]").exists())
                .andExpect(jsonPath("$.personnes[77].theses[?(@.id=='2011ANGE0040')]").exists())
                .andExpect(jsonPath("$.personnes[79].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[80].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[81].theses[?(@.id=='2021SORUL154')]").exists())
                .andExpect(jsonPath("$.personnes[82].theses[?(@.id=='2020REN1B015')]").exists())
                .andExpect(jsonPath("$.personnes[83].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[84].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[85].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[86].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[87].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[88].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[89].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[91].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[92].theses[?(@.id=='2020AIXM0184')]").exists());
    }

    @Test
    @DisplayName("Tri Z-A sur la recherche de personnes")
    @EnableOnIntegrationTest
    public void triZA() throws Exception {
        mockMvc.perform(get("/api/v1/tests/personnes/recherche/?q=*&index=per_recherche_simple_nom_prenom&tri=PersonnesDesc&debut=0&nombre=1000"))
                .andExpect(status().isOk())
                .andExpect(jsonPath("$.personnes[0].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[1].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[3].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[4].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[5].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[6].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[7].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[8].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[9].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[10].theses[?(@.id=='2020REN1B015')]").exists())
                .andExpect(jsonPath("$.personnes[11].theses[?(@.id=='2021SORUL154')]").exists())
                .andExpect(jsonPath("$.personnes[12].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[13].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[14].theses[?(@.id=='2004BRES2040')]").exists())
                .andExpect(jsonPath("$.personnes[15].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[16].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[17].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[19].theses[?(@.id=='2007PA066375')]").exists())
                .andExpect(jsonPath("$.personnes[20].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[21].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[22].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[23].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[24].theses[?(@.id=='1997PA040286')]").exists())
                .andExpect(jsonPath("$.personnes[25].theses[?(@.id=='2020PA01H073')]").exists())
                .andExpect(jsonPath("$.personnes[26].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[27].theses[?(@.id=='2021SORUL154')]").exists())
                .andExpect(jsonPath("$.personnes[28].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[29].theses[?(@.id=='2003PA066582')]").exists())
                .andExpect(jsonPath("$.personnes[30].theses[?(@.id=='2011ANGE0040')]").exists())
                .andExpect(jsonPath("$.personnes[32].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[33].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[34].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[35].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[36].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[37].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[38].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[39].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[40].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[41].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[42].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[43].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[44].theses[?(@.id=='1999ROUES082')]").exists())
                .andExpect(jsonPath("$.personnes[45].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[46].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[47].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[48].theses[?(@.id=='1997PA040286')]").exists())
                .andExpect(jsonPath("$.personnes[49].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[50].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[51].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[52].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[53].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[54].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[55].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[56].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[57].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[58].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[59].theses[?(@.id=='2017ECLI0025')]").exists())
                .andExpect(jsonPath("$.personnes[60].theses[?(@.id=='2020PA01H073')]").exists())
                .andExpect(jsonPath("$.personnes[61].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[62].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[63].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[64].theses[?(@.id=='2004BRES2040')]").exists())
                .andExpect(jsonPath("$.personnes[65].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[66].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[67].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[68].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[69].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[70].theses[?(@.id=='2020REN1B015')]").exists())
                .andExpect(jsonPath("$.personnes[71].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[72].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[73].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[74].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[75].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[76].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[77].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[78].theses[?(@.id=='2017PA01H038')]").exists())
                .andExpect(jsonPath("$.personnes[79].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[80].theses[?(@.id=='2019LYSE2095')]").exists())
                .andExpect(jsonPath("$.personnes[81].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[82].theses[?(@.id=='2016SACLN057')]").exists())
                .andExpect(jsonPath("$.personnes[83].theses[?(@.id=='2019LYSES011')]").exists())
                .andExpect(jsonPath("$.personnes[84].theses[?(@.id=='2020AIXM0184')]").exists())
                .andExpect(jsonPath("$.personnes[85].theses[?(@.id=='2021AIXM0253')]").exists())
                .andExpect(jsonPath("$.personnes[86].theses[?(@.id=='2017GREAM026')]").exists())
                .andExpect(jsonPath("$.personnes[87].theses[?(@.id=='2007PA066375')]").exists())
                .andExpect(jsonPath("$.personnes[89].theses[?(@.id=='2018LYSE1193')]").exists())
                .andExpect(jsonPath("$.personnes[90].theses[?(@.id=='1999ROUES082')]").exists())
                .andExpect(jsonPath("$.personnes[91].theses[?(@.id=='2003PA066582')]").exists())
                .andExpect(jsonPath("$.personnes[92].theses[?(@.id=='2011ANGE0040')]").exists());
    }
}
